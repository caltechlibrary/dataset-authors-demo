{"title":"FlyLimbTracker: An active contour based approach for leg segment tracking in unmarked, freely behaving Drosophila","uri":"","abstract":"Understanding the biological underpinnings of movement and action requires the development of tools for quantitative measurements of animal behavior. Drosophila melanogaster provides an ideal model for developing such tools: the fly has unparalleled genetic accessibility and depends on a relatively compact nervous system to generate sophisticated limbed behaviors including walking, reaching, grooming, courtship, and boxing. Here we describe a method that uses active contours to semi-automatically track body and leg segments from video image sequences of unmarked, freely behaving D. melanogaster. We show that this approach yields a more than 6-fold reduction in user intervention when compared with fully manual annotation and can be used to annotate videos with low spatial or temporal resolution for a variety of locomotor and grooming behaviors. FlyLimbTracker, the software implementation of this method, is open-source and our approach is generalizable. This opens up the possibility of tracking leg movements in other species by modifications of underlying active contour models.","documents":[{"id":"http://authors.library.caltech.edu/id/document/253055","docid":253055,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265764","fileid":1265764,"datasetid":"document","objectid":253055,"filename":"journal.pone.0173433.pdf","mime_type":"application/pdf","hash":"aaf4deceef63ade270c3813c77861489","hash_type":"MD5","filesize":10730814,"mtime":"2017-06-02 16:21:51","url":"http://authors.library.caltech.edu/77910/1/journal.pone.0173433.pdf"}],"eprintid":77910,"pos":1,"placement":1,"mime_type":"application/pdf","format":"application/pdf","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.pdf","content":"published"},{"id":"http://authors.library.caltech.edu/id/document/253056","docid":253056,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265770","fileid":1265770,"datasetid":"document","objectid":253056,"filename":"journal.pone.0173433.s001.mov","mime_type":"video/quicktime","hash":"2cf6e1d6ffe2461a6a7cad685dc5635d","hash_type":"MD5","filesize":5048800,"mtime":"2017-06-02 16:27:19","url":"http://authors.library.caltech.edu/77910/2/journal.pone.0173433.s001.mov"}],"eprintid":77910,"pos":2,"placement":2,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s001.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253057","docid":253057,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265772","fileid":1265772,"datasetid":"document","objectid":253057,"filename":"journal.pone.0173433.s002.mov","mime_type":"video/quicktime","hash":"cbf6a75bf8e6d8983f5e701ae4c591d4","hash_type":"MD5","filesize":5425103,"mtime":"2017-06-02 16:27:53","url":"http://authors.library.caltech.edu/77910/3/journal.pone.0173433.s002.mov"}],"eprintid":77910,"pos":3,"placement":3,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s002.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253058","docid":253058,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265775","fileid":1265775,"datasetid":"document","objectid":253058,"filename":"journal.pone.0173433.s003.mov","mime_type":"video/quicktime","hash":"0016c456e43615f0623f09145685693b","hash_type":"MD5","filesize":3723677,"mtime":"2017-06-02 16:28:13","url":"http://authors.library.caltech.edu/77910/4/journal.pone.0173433.s003.mov"}],"eprintid":77910,"pos":4,"placement":4,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s003.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253059","docid":253059,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265777","fileid":1265777,"datasetid":"document","objectid":253059,"filename":"journal.pone.0173433.s004.mov","mime_type":"video/quicktime","hash":"f453ca8ed12b66350f95954dc19dcedf","hash_type":"MD5","filesize":4063670,"mtime":"2017-06-02 16:28:33","url":"http://authors.library.caltech.edu/77910/5/journal.pone.0173433.s004.mov"}],"eprintid":77910,"pos":5,"placement":5,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s004.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253060","docid":253060,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265780","fileid":1265780,"datasetid":"document","objectid":253060,"filename":"journal.pone.0173433.s005.mov","mime_type":"video/quicktime","hash":"462d16ed5dd314c65136dbd905e46aee","hash_type":"MD5","filesize":4945867,"mtime":"2017-06-02 16:28:53","url":"http://authors.library.caltech.edu/77910/6/journal.pone.0173433.s005.mov"}],"eprintid":77910,"pos":6,"placement":6,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s005.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253061","docid":253061,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265782","fileid":1265782,"datasetid":"document","objectid":253061,"filename":"journal.pone.0173433.s006.mov","mime_type":"video/quicktime","hash":"198512080df3aed0d25177c83ef1c827","hash_type":"MD5","filesize":5533270,"mtime":"2017-06-02 16:29:17","url":"http://authors.library.caltech.edu/77910/7/journal.pone.0173433.s006.mov"}],"eprintid":77910,"pos":7,"placement":7,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s006.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253062","docid":253062,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265784","fileid":1265784,"datasetid":"document","objectid":253062,"filename":"journal.pone.0173433.s007.mov","mime_type":"video/quicktime","hash":"860fceea7ddb0450a8edf40153b812e9","hash_type":"MD5","filesize":5205607,"mtime":"2017-06-02 16:29:43","url":"http://authors.library.caltech.edu/77910/8/journal.pone.0173433.s007.mov"}],"eprintid":77910,"pos":8,"placement":8,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s007.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253063","docid":253063,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265786","fileid":1265786,"datasetid":"document","objectid":253063,"filename":"journal.pone.0173433.s008.mov","mime_type":"video/quicktime","hash":"35fec1648d7b6bbc346ca2bfdf761bb1","hash_type":"MD5","filesize":3494156,"mtime":"2017-06-02 16:30:06","url":"http://authors.library.caltech.edu/77910/9/journal.pone.0173433.s008.mov"}],"eprintid":77910,"pos":9,"placement":9,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s008.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253064","docid":253064,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265788","fileid":1265788,"datasetid":"document","objectid":253064,"filename":"journal.pone.0173433.s009.mov","mime_type":"video/quicktime","hash":"4fcbae2bf76307c4b10aaa76bc8dc639","hash_type":"MD5","filesize":3316189,"mtime":"2017-06-02 16:30:30","url":"http://authors.library.caltech.edu/77910/10/journal.pone.0173433.s009.mov"}],"eprintid":77910,"pos":10,"placement":10,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s009.mov","content":"supplemental"},{"id":"http://authors.library.caltech.edu/id/document/253066","docid":253066,"rev_number":2,"files":[{"id":"http://authors.library.caltech.edu/id/file/1265793","fileid":1265793,"datasetid":"document","objectid":253066,"filename":"journal.pone.0173433.s010.mov","mime_type":"video/quicktime","hash":"6827bc9d09110cae9dad605179520fda","hash_type":"MD5","filesize":5216196,"mtime":"2017-06-02 16:30:52","url":"http://authors.library.caltech.edu/77910/11/journal.pone.0173433.s010.mov"}],"eprintid":77910,"pos":11,"placement":11,"mime_type":"video/quicktime","format":"video/quicktime","language":"en","security":"public","license":"cc_by","main":"journal.pone.0173433.s010.mov","content":"supplemental"}],"note":"© 2017 Uhlmann et al. This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited. \n\nReceived: January 1, 2017; Accepted: February 11, 2017; Published: April 28, 2017. \n\nWe thank Cédric Vonesch, Michael Rusterholz, and Loic Perruchoud for early contributions to the body tracking algorithm. \n\nData Availability Statement: User instructions, FlyLimbTracker software, sample data, and a video demonstration of a complete data analysis pipeline can be found at: http://bigwww.epfl.ch/algorithms/FlyLimbTracker/ and at https://doi.org/10.6084/m9.figshare.4688962.v1. \n\nThis work was supported by Swiss SystemsX.ch Initiative, Grant#: 2008/005, http://www.systemsx.ch/, VU, RDG, MU; Swiss National Science Foundation, Grant#: 200020-121763 and 200020-144355, http://www.snf.ch/en/Pages/default.aspx, VU, RDG, MU; Human Frontier Science Program, Grant#: LT000057/2009, http://www.hfsp.org/, PR; Swiss National Science Foundation, Grant#: P300P3_158511, http://www.snf.ch/en/Pages/default.aspx, PR; European Research Council, Grant#: 205202 and 615094, https://erc.europa.eu/, RB. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. \n\nAuthor Contributions: \nConceptualization: PR VU MU.\nData curation: PR VU.\nFormal analysis: VU RDG PR.\nFunding acquisition: PR RB MU.\nInvestigation: PR VU.\nMethodology: VU RDG MU.\nProject administration: PR MU.\nResources: RB MU.\nSoftware: VU RDG PR.\nSupervision: PR RB MU.\nValidation: VU RDG PR.\nVisualization: PR VU.\nWriting – original draft: PR VU.\nWriting – review \u0026 editing: PR VU RDG RB MU. \n\nThe authors have declared that no competing interests exist.","id":77910,"rev_number":24,"userid":18,"eprint_dir":"disk0/00/07/79/10","datestamp":"2017-06-02 18:19:28","lastmod":"2017-06-02 18:25:08","status_changed":"2017-06-02 18:19:28","type":"article","metadata_visibility":"show","creators":[{"given":"Virginie","family":"Uhlmann","id":"Uhlmann-V","orcid":""},{"given":"Pavan","family":"Ramdya","id":"Ramdya-P","orcid":""},{"given":"Ricard","family":"Delgado-Gonzalo","id":"Delgado-Gonzalo-R","orcid":""},{"given":"Richard","family":"Benton","id":"Benton-R","orcid":""},{"given":"Michael","family":"Unser","id":"Unser-M","orcid":""}],"ispublished":"pub","subjects":null,"full_text_status":"public","keywords":"","date":"2017-04-28","date_type":"published","publication":"PLOS ONE","volume":"12","number":"4","pagerange":"Art. No. e0173433","id_number":"CaltechAUTHORS:20170602-092136915","refereed":true,"issn":"1932-6203","official_url":"http://resolver.caltech.edu/CaltechAUTHORS:20170602-092136915","related_url":[{"url":"https://doi.org/10.1371/journal.pone.0173433","type":"doi","description":"Article"},{"url":"http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0173433","type":"pub","description":"Article"},{"url":"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5409058/","type":"pmc","description":"Article"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s001","type":"doi","description":"S1 Video. A fly walking straight"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s002","type":"doi","description":"S2 Video. A fly turning"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s003","type":"doi","description":"S3 Video. A fly grooming its forelegs"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s004","type":"doi","description":"S4 Video. A fly grooming its head"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s005","type":"doi","description":"S5 Video. A fly grooming its abdomen"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s006","type":"doi","description":"S6 Video. A fly walking straight (video 1), annotated using FlyLimbTracker"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s007","type":"doi","description":"S7 Video. A fly turning (video 2), annotated using FlyLimbTracker"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s008","type":"doi","description":"S8 Video. A fly grooming its forelegs (video 3), annotated using FlyLimbTracker"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s009","type":"doi","description":"S9 Video. A fly grooming its head (video 4), annotated using FlyLimbTracker"},{"url":"https://doi.org/10.1371/journal.pone.0173433.s010","type":"doi","description":"S10 Video. A fly grooming its abdomen (video 5), annotated using FlyLimbTracker"}],"referencetext":["1. Olsen SR, Wilson RI. Cracking neural circuits in a tiny brain: new approaches for understanding the neural circuitry of Drosophila. Trends Neurosci. 2008;31: 512–520. pmid:18775572  View Article \n• PubMed/NCBI \n• Google Scholar \n\n2. Noldus L, Spink AJ, Tegelenbosch R. Computerised video tracking, movement analysis and behaviour recognition in insects. Computers and Electronics in agriculture. 2002;35: 201–227.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n3. Dankert H, Wang L, Hoopfer E, Anderson DJ, Perona P. Automated monitoring and analysis of social behavior in Drosophila. Nature Methods. 2009;6: 297–303. pmid:19270697  View Article \n• PubMed/NCBI \n• Google Scholar \n\n4. Branson KM, Robie AA, Bender JA, Perona P, Dickinson MH. High-throughput ethomics in large groups of Drosophila. Nature Methods. Nature Publishing Group; 2009;6: 451–457. pmid:19412169  View Article \n• PubMed/NCBI \n• Google Scholar \n\n5. Donelson N, Kim EZ, Slawson JB, Vecsey CG, Huber R, Griffith LC. High-Resolution Positional Tracking for Long-Term Analysis of Drosophila Sleep and Locomotion Using the “Tracker” Program. PLoS One. 2012;7: e37250. pmid:22615954  View Article \n• PubMed/NCBI \n• Google Scholar \n\n6. Pérez-Escudero A, Vicente-Page J, Hinz RC, Arganda S, de Polavieja GG. idTracker: tracking individuals in a group by automatic identification of unmarked animals. Nature Methods. 2014;11: 743–748. pmid:24880877  View Article \n• PubMed/NCBI \n• Google Scholar \n\n7. Deng Y, Coen P, Sun M, Shaevitz JW. Efficient Multiple Object Tracking Using Mutually Repulsive Active Membranes. PLoS One. 2013;8: e65769. pmid:23799046  View Article \n• PubMed/NCBI \n• Google Scholar \n\n8. Berman GJ, Choi DM, Bialek W, Shaevitz JW. Mapping the stereotyped behaviour of freely moving fruit flies. Journal of The Royal Society Interface. 2014;11: 20140672–20140672.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n9. Berman GJ, Bialek W, Shaevitz JW. Predictability and hierarchy in Drosophila behavior. Proceedings of the National Academy of Sciences. 2016;113: 11943–11948.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n10. Kain J, Stokes C, Gaudry Q, Song X, Foley J, Wilson RI, et al. Leg-tracking and automated behavioural classification in Drosophila. Nature Communications. 2013;4: 1910–1918. pmid:23715269  View Article \n• PubMed/NCBI \n• Google Scholar \n\n11. Bender JA, Simpson EM, Ritzmann RE. Computer-Assisted 3D Kinematic Analysis of All Leg Joints in Walking Insects. PLoS One. 2010;5: e13617. pmid:21049024  View Article \n• PubMed/NCBI \n• Google Scholar \n\n12. Mendes CS, Bartos I, Akay T, Márka S, Mann RS. Quantification of gait parameters in freely walking wild type and sensory deprived Drosophila melanogaster. eLife. 2013;2.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n13. Isakov A, Buchanan SM, Sullivan B. Recovery of locomotion after injury in Drosophila melanogaster depends on proprioception. Journal of …. 2016.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n14. Pick S, Strauss R. Goal-Driven Behavioral Adaptations in Gap-Climbing Drosophila. Current Biology. 2005;15: 1473–1478. pmid:16111941  View Article \n• PubMed/NCBI \n• Google Scholar \n\n15. Seeds AM, Ravbar P, Chung P, Hampel S, Midgley FM, Mensh BD, et al. A suppression hierarchy among competing motor programs drives sequential grooming in Drosophila. eLife. 2014;3.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n16. de Chaumont F, Dallongeville S, Chenouard N, Hervé N, Pop S, Provoost T, et al. Icy: an open bioimage informatics platform for extended reproducible research. Nature Methods. 2012;9: 690–696. pmid:22743774  View Article \n• PubMed/NCBI \n• Google Scholar \n\n17. de Chaumont F, Coura RD-S, Serreau P, Cressant A, Chabout J, Granon S, et al. Computerized video analysis of social interactions in mice. Nature Methods. 2012;9: 410–417. pmid:22388289  View Article \n• PubMed/NCBI \n• Google Scholar \n\n18. Chenouard N, Buisson J, Bloch I, Bastin P, Olivo-Marin J-C. Curvelet analysis of kymograph for tracking bi-directional particles in fluorescence microscopy images. IEEE 17th International Conference on Image Processing. 2010;: 3657–3660. \n19. Delgado-Gonzalo R, Uhlmann V, Schmitter D, Unser M. Snakes on a Plane: A perfect snap for bioimage analysis. IEEE Signal Process Mag. 2015;32: 41–48.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n20. Dénervaud N, Becker J. A chemostat array enables the spatio-temporal analysis of the yeast proteome. 2013. pp. 15842–15847. \n21. Schmitter D, Wachowicz P, Sage D, Chasapi A, Xenarios I, Simanis V, et al. A 2D/3D image analysis system to track fluorescently labeled structures in rod-shaped cells: application to measure spindle pole asymmetry during mitosis. Cell Division. 2013;8.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n22. Kass M, Witkin A, Terzopoulos D. Snakes: Active contour models. International journal of computer vision. 1988;: 321–331.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n23. Delgado-Gonzalo R, Chenouard N, Unser M. Spline-Based Deforming Ellipsoids for Interactive 3D Bioimage Segmentation. IEEE Transactions on Image Processing. 2013;22: 3926–3940. pmid:23708807  View Article \n• PubMed/NCBI \n• Google Scholar \n\n24. Brigger P, Hoeg J, Unser M. B-spline snakes: a flexible tool for parametric contour detection. IEEE Transactions on Image Processing. 2000;9: 1484–1496. pmid:18262987  View Article \n• PubMed/NCBI \n• Google Scholar \n\n25. Delgado-Gonzalo R, Thévenaz P, Unser M. Computer Aided Geometric Design. Computer Aided Geometric Design. Elsevier B.V; 2012;29: 109–128.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n26. Delgado-Gonzalo R, Thévenaz P, Seelamantula CS, Unser M. Snakes With an Ellipse-Reproducing Property. IEEE Transactions on Image Processing. 2012;21: 1258–1271. pmid:21965208  View Article \n• PubMed/NCBI \n• Google Scholar \n\n27. Jacob M, Blu T, Unser M. Efficient Energies and Algorithms for Parametric Snakes. IEEE Transactions on Image Processing. 2004;13: 1231–1244. pmid:15449585  View Article \n• PubMed/NCBI \n• Google Scholar \n\n28. Delgado-Gonzalo R, Schmitter D, Uhlmann V, Unser M. Efficient Shape Priors for Spline-Based Snakes. IEEE Transactions on Image Processing. 2015;24: 3915–3926. pmid:26353353  View Article \n• PubMed/NCBI \n• Google Scholar \n\n29. Press WH, Flannery BP, Teukolsky SA, Vetterling WT. Numerical recipes: the art of scientific computing. Cambridge University Press; 1986. \n30. Dijkstra EW. A note on two problems in connexion with graphs. Numerische mathematik. 1959;: 269–271.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n31. Jacob M, Unser M. Design of steerable filters for feature detection using canny-like criteria. IEEE Transactions on Pattern Analysis and Machine Intelligence. 2004;26: 1007–1019. pmid:15641731  View Article \n• PubMed/NCBI \n• Google Scholar \n\n32. Felzenszwalb PF, Huttenlocher DP. Distance Transforms of Sampled Functions. Theory of Computing. 2012;8: 415–428.  View Article \n• PubMed/NCBI \n• Google Scholar \n\n33. Sage D, Neumann FR, Hediger F, Gasser SM, Unser M. Automatic tracking of individual fluorescence particles: application to the study of chromosome dynamics. IEEE Transactions on Image Processing. 2005;14: 1372–1383. pmid:16190472  View Article \n• PubMed/NCBI \n• Google Scholar \n\n34. Wosnitza A, Bockemühl T, Dübbert M, Scholz H, Büschges A. Inter-leg coordination in the control of walking speed in Drosophila. The Journal of Experimental biology. 2013;216: 480–491. pmid:23038731  View Article \n• PubMed/NCBI \n• Google Scholar \n\n35. Kuhn HW. The Hungarian method for the assignment problem. Naval research logistics quarterly. 1955;: 83–97.\n"],"rights":"No commercial reproduction, distribution, display or performance rights in this work are provided.","official_citation":"Uhlmann V, Ramdya P, Delgado-Gonzalo R, Benton R, Unser M (2017) FlyLimbTracker: An active contour based approach for leg segment tracking in unmarked, freely behaving Drosophila.\nPLoS ONE 12(4): e0173433. https://doi.org/10.1371/journal.pone.0173433","other_numbering_system":null,"funders":[{"agency":"Swiss SystemsX.ch Initiative","grant_number":"2008/005"},{"agency":"Swiss National Science Foundation (SNSF)","grant_number":"200020-121763"},{"agency":"Swiss National Science Foundation (SNSF)","grant_number":"200020-144355"},{"agency":"Human Frontier Science Program","grant_number":"LT000057/2009"},{"agency":"Swiss National Science Foundation (SNSF)","grant_number":"P300P3_158511"},{"agency":"European Research Council (ERC)","grant_number":"205202"},{"agency":"European Research Council (ERC)","grant_number":"615094"}],"collection":"CaltechAUTHORS","reviewer":"George Porter","local_group":null}